package com.secure.ai.burp.generators.payload.generators;
import burp.api.montoya.http.HttpRequestToBeSent; import com.secure.ai.burp.models.ml.ModelManager; import com.secure.ai.burp.generators.payload.GeneratedPayload; import com.secure.ai.burp.generators.payload.PayloadContext; import java.util.*; import java.util.concurrent.atomic.AtomicInteger;
class DeserializationPayloadGenerator implements PayloadGeneratorStrategy { private final ModelManager modelManager; private final AtomicInteger generatedCount = new AtomicInteger(0); public DeserializationPayloadGenerator(ModelManager modelManager) { this.modelManager = modelManager; } @Override public List<GeneratedPayload> generatePayloads(HttpRequestToBeSent request, PayloadContext context) { return new ArrayList<>(); } @Override public GeneratedPayload customizePayload(String basePayload, PayloadContext context) { return new GeneratedPayload.Builder(basePayload, "deserialization", context).build(); } @Override public String getVulnerabilityType() { return "deserialization"; } @Override public int getGeneratedCount() { return generatedCount.get(); } @Override public void updateLearning(GeneratedPayload payload, boolean wasSuccessful, double actualEffectiveness) {} @Override public double getContextualPriority(PayloadContext context) { return 0.9; } @Override public boolean isApplicable(PayloadContext context) { return context.hasSerializedData(); } }